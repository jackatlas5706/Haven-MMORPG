<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fantasy MMORPG</title>
    <style>
        body{
            margin:0;padding:25px;
            font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
            background:linear-gradient(135deg,#2c1810 0%,#4a2c18 100%);
            color:#f0e6d2;min-height:100vh;
        }
        .game-container{
            max-width:1200px;margin:auto;
            border:3px solid #8b4513;border-radius:10px;
            background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%233e2723"/><path d="M0 0L100 100M100 0L0 100" stroke="%235d4037" stroke-width="1"/></svg>');
            box-shadow:0 0 20px rgba(139,69,19,.7);
            padding:20px;
        }
        .game-header{text-align:center;padding:15px;border-bottom:2px solid #8b4513;margin-bottom:20px;}
        .title{color:#d4af37;text-shadow:0 0 10px rgba(212,175,55,.5);font-size:2.5em;letter-spacing:2px;}
        .current-time{font-size:1.2em;color:#d4af37;}
        .player-stats{display:flex;justify-content:space-between;margin-bottom:30px;gap:20px;}
        .stat-box{
            background:rgba(40,20,10,.7);
            border:2px solid #8b4513;border-radius:8px;
            padding:15px;flex:1;
            box-shadow:0 4px 8px rgba(0,0,0,.3);
        }
        .stat-box h3{margin:10px 0;color:#d4af37;}
        .progress-bar{
            width:100%;height:20px;background:#333;
            border-radius:10px;overflow:hidden;
            margin-top:10px;border:1px solid #5d4037;
        }
        .progress-fill{
            height:100%;background:linear-gradient(90deg,#4caf50,#8bc34a);
            border-radius:10px;transition:width .5s ease;
        }
        .health-fill{background:linear-gradient(90deg,#f44336,#ff9800);}
        .energy-fill{background:linear-gradient(90deg,#2196f3,#03a9f4);}
        .game-content{display:flex;gap:20px;margin-bottom:30px;}
        .actions-panel,.log-panel,.shop-panel{
            background:rgba(40,20,10,.7);
            border:2px solid #8b4513;border-radius:8px;
            padding:20px;box-shadow:0 4px 8px rgba(0,0,0,.3);
        }
        .actions-panel{flex:1;}
        .log-panel{flex:2;}
        .actions-panel h2,
        .shop-panel h2{color:#d4af37;border-bottom:1px solid #8b4513;padding-bottom:10px;margin-top:0;}
        .action-button{
            display:block;width:100%;padding:12px;margin:10px 0;
            background:linear-gradient(to bottom,#8b4513,#5d2906);
            color:#f0e6d2;border:none;border-radius:5px;
            cursor:pointer;font-size:1.1em;transition:all .3s;
            border:1px solid #d4af37;
        }
        .action-button:hover{
            background:linear-gradient(to bottom,#a0522d,#7d3c0a);
            transform:translateY(-2px);
            box-shadow:0 4px 8px rgba(0,0,0,.3);
        }
        .event-log{
            height:200px;overflow-y:auto;
            background:rgba(20,10,5,.5);
            border:1px solid #5d4037;border-radius:5px;
            padding:10px;font-family:monospace;
        }
        .shop-items{display:flex;flex-direction:column;gap:15px;}
        .shop-item{
            display:flex;justify-content:space-between;align-items:center;
            padding:10px;background:rgba(60,30,15,.5);
            border:1px solid #5d4037;border-radius:5px;
        }
        .buy-button{
            background:linear-gradient(to bottom,#2196f3,#0d47a1);
            color:white;border:none;padding:8px 15px;
            border-radius:4px;cursor:pointer;transition:all .3s;
        }
        .buy-button:hover{
            background:linear-gradient(to bottom,#42a5f5,#1565c0);
            transform:scale(1.05);
        }
        @media (max-width:768px){
            .player-stats{flex-direction:column;}
            .game-content{flex-direction:column;}
        }
    </style>
</head>
<body>
    <div class="game-container">
        <header class="game-header">
            <h1 class="title">Eternal Realms</h1>
            <div id="currentTime" class="current-time"></div>
        </header>

        <div class="player-stats">
            <div class="stat-box">
                <h3>Level: <span id="playerLevel">1</span></h3>
                <h3>EXP: <span id="playerExp">0</span>/<span id="expToNext">100</span></h3>
                <div class="progress-bar"><div id="expBar" class="progress-fill"></div></div>
            </div>

            <div class="stat-box">
                <h3>Gold: <span id="goldAmount">100</span></h3>
                <h3>Health: <span id="playerHealth">100</span>/<span id="maxHealth">100</span></h3>
                <div class="progress-bar"><div id="healthBar" class="progress-fill health-fill"></div></div>
            </div>

            <div class="stat-box">
                <h3>Energy: <span id="playerEnergy">100</span>/<span id="maxEnergy">100</span></h3>
                <div class="progress-bar"><div id="energyBar" class="progress-fill energy-fill"></div></div>
            </div>
        </div>

        <div class="game-content">
            <div class="actions-panel">
                <h2>Actions</h2>
                <button id="questButton" class="action-button">Accept Quest</button>
                <button id="trainButton" class="action-button">Train Stats (5 Energy)</button>
                <button id="pvpButton" class="action-button">PvP Battle</button>
                <button id="restButton" class="action-button">Rest & Recover</button>
            </div>

            <div class="log-panel">
                <h2>Adventure Log</h2>
                <div id="eventLog" class="event-log"></div>
            </div>
        </div>

        <div class="shop-panel">
            <h2>Blacksmith Shop</h2>
            <div class="shop-items">
                <div class="shop-item"><span>Iron Sword (+10 Attack)</span><button class="buy-button" data-item="sword">Buy (50 Gold)</button></div>
                <div class="shop-item"><span>Leather Armor (+15 Defense)</span><button class="buy-button" data-item="armor">Buy (75 Gold)</button></div>
                <div class="shop-item"><span>Health Potion (+50 HP)</span><button class="buy-button" data-item="potion">Buy (25 Gold)</button></div>
            </div>
        </div>
    </div>

    <!-- Game Logic -->
    <script>
        // ---------- PLAYER ----------
        const player = {
            level: 1,
            exp: 0,
            expToNext: 100,
            gold: 100,
            health: 100,
            maxHealth: 100,
            attack: 10,
            defense: 5,
            energy: 100,
            maxEnergy: 100,
            inventory: []
        };

        // ---------- UI ----------
        const eventLog = document.getElementById('eventLog');

        function logEvent(msg){
            const e = document.createElement('div');
            e.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
            eventLog.appendChild(e);
            eventLog.scrollTop = eventLog.scrollHeight;
        }

        function updateUI(){
            document.getElementById('playerLevel').textContent   = player.level;
            document.getElementById('playerExp').textContent     = player.exp;
            document.getElementById('expToNext').textContent     = player.expToNext;
            document.getElementById('goldAmount').textContent    = player.gold;
            document.getElementById('playerHealth').textContent  = player.health;
            document.getElementById('maxHealth').textContent     = player.maxHealth;
            document.getElementById('playerEnergy').textContent  = player.energy;
            document.getElementById('maxEnergy').textContent     = player.maxEnergy;

            document.getElementById('expBar').style.width    = `${(player.exp/player.expToNext)*100}%`;
            document.getElementById('healthBar').style.width = `${(player.health/player.maxHealth)*100}%`;
            document.getElementById('energyBar').style.width = `${(player.energy/player.maxEnergy)*100}%`;
        }

        // ---------- GAME LOGIC ----------
        function gainExp(amount){
            player.exp += amount;
            logEvent(`Gained ${amount} EXP`);
            if (player.exp >= player.expToNext) levelUp();
            updateUI();
        }

        function levelUp(){
            player.level++;
            player.exp -= player.expToNext;
            player.expToNext = Math.floor(player.expToNext * 1.5);
            player.maxHealth += 20;
            player.health = player.maxHealth;
            player.attack += 5;
            player.defense += 3;
            player.energy = player.maxEnergy; // refill energy on level up
            logEvent(`Level Up! You are now level ${player.level}`);
            updateUI();
        }

        function gainGold(amount){
            player.gold += amount;
            logEvent(`Gained ${amount} gold`);
            updateUI();
        }

        // ----- Actions -----
        function acceptQuest(){
            const rewards = [
                {exp:50, gold:25},
                {exp:75, gold:50},
                {exp:100,gold:75}
            ];
            const r = rewards[Math.floor(Math.random()*rewards.length)];
            gainExp(r.exp);
            gainGold(r.gold);
            logEvent(`Quest completed! (+${r.exp} EXP, +${r.gold} gold)`);
        }

        function trainStats(){
            const ENERGY_COST = 5;   // *** changed from 20 to 5 ***
            const GOLD_COST   = 50;

            if (player.gold < GOLD_COST){
                logEvent('Not enough gold to train.');
                return;
            }
            if (player.energy < ENERGY_COST){
                logEvent('Not enough energy to train.');
                return;
            }

            player.gold   -= GOLD_COST;
            player.energy -= ENERGY_COST;
            player.attack += 2;
            player.defense+= 1;
            logEvent('Trained: +2 Attack, +1 Defense (5 Energy, 50 Gold)');
            updateUI();
        }

        function rest(){
            player.health = player.maxHealth;
            player.energy = player.maxEnergy;
            logEvent('Rested – health and energy fully restored.');
            updateUI();
        }

        function startPvP(){
            const enemyLevel   = Math.max(1, player.level + Math.floor(Math.random()*3) - 1);
            const enemyAttack  = Math.floor(enemyLevel*5 + Math.random()*10);
            const enemyDefense = Math.floor(enemyLevel*2 + Math.random()*5);
            const enemyHealth  = Math.floor(enemyLevel*20 + Math.random()*30);

            logEvent(`Encountered Level ${enemyLevel} enemy!`);

            const playerDamage = Math.max(1, player.attack - enemyDefense + Math.floor(Math.random()*5));
            if (playerDamage >= enemyHealth){
                const expGain = enemyLevel*10;
                const goldGain= enemyLevel*5;
                gainExp(expGain);
                gainGold(goldGain);
                logEvent(`Victory! (+${expGain} EXP, +${goldGain} gold)`);
            }else{
                const enemyDamage = Math.max(1, enemyAttack - player.defense + Math.floor(Math.random()*5));
                player.health = Math.max(1, player.health - enemyDamage);
                logEvent(`Defeated! Lost ${enemyDamage} HP.`);
                if (player.health <= 0){
                    player.health = player.maxHealth;
                    logEvent('You were revived by a healer!');
                }
            }
            updateUI();
        }

        // ----- Shop -----
        function buyItem(type){
            let cost, effect, msg;
            switch(type){
                case 'sword':
                    cost=50; effect={attack:10}; msg='Bought Iron Sword (+10 Attack)'; break;
                case 'armor':
                    cost=75; effect={defense:15}; msg='Bought Leather Armor (+15 Defense)'; break;
                case 'potion':
                    cost=25; effect={health:50}; msg='Bought Health Potion (+50 HP)'; break;
                default: return;
            }
            if (player.gold < cost){
                logEvent('Not enough gold for this item.');
                return;
            }
            player.gold -= cost;
            if (effect.attack)  player.attack  += effect.attack;
            if (effect.defense) player.defense += effect.defense;
            if (effect.health){
                player.health = Math.min(player.maxHealth, player.health + effect.health);
            }
            logEvent(msg);
            updateUI();
        }

        // ---------- ENERGY REGEN ----------
        // Add 5 energy every 3 minutes (180 000 ms), capped at maxEnergy
        setInterval(()=>{
            if (player.energy < player.maxEnergy){
                const before = player.energy;
                player.energy = Math.min(player.maxEnergy, player.energy + 5);
                const gained = player.energy - before;
                if (gained > 0) logEvent(`Energy regenerated +${gained}`);
                updateUI();
            }
        }, 180000); // 3 minutes

        // ---------- EVENT LISTENERS ----------
        document.getElementById('questButton').addEventListener('click', acceptQuest);
        document.getElementById('trainButton').addEventListener('click', trainStats);
        document.getElementById('pvpButton').addEventListener('click', startPvP);
        document.getElementById('restButton').addEventListener('click', rest);
        document.querySelectorAll('.buy-button').forEach(btn=>{
            btn.addEventListener('click',()=>buyItem(btn.dataset.item));
        });

        // ---------- TIME DISPLAY ----------
        function updateClock(){
            document.getElementById('currentTime').textContent =
                new Date().toLocaleTimeString();
        }
        setInterval(updateClock, 1000);
        updateClock();

        // ---------- INITIALISE ----------
        updateUI();
        logEvent('Welcome to Eternal Realms! Begin your adventure.');
    </script>
</body>
</html>
